# =======================================================================================
#  VARIABLES DE ENTORNO 
# =======================================================================================
# Configuración pensada para maximizar la compatibilidad y estabilidad
# en sistemas con NVIDIA Optimus (Intel + NVIDIA) bajo Hyprland.
# =======================================================================================

# --------------------------------------------------
# CONFIGURACIÓN FUNDAMENTAL DE WAYLAND
# --------------------------------------------------
env = XDG_SESSION_TYPE,wayland
# Define que la sesión es de tipo Wayland. Crítico para que las apps usen el backend correcto.

# --------------------------------------------------
# COMPATIBILIDAD DE APLICACIONES EN WAYLAND
# --------------------------------------------------
env = GDK_BACKEND,wayland,x11
# Para aplicaciones GTK (GIMP, Firefox): intenta Wayland y permite fallback a X11.

env = SDL_VIDEODRIVER,wayland
# Para juegos y apps que usan SDL2: les indica que usen el backend de Wayland.

env = CLUTTER_BACKEND,wayland
# Para apps que usan el toolkit Clutter: les indica que usen Wayland.

env = ELECTRON_OZONE_PLATFORM_HINT,auto
# Para apps basadas en Electron (Discord, VSCode): mejora la integración con Wayland.

#env = OZONE_PLATFORM,wayland
# Alternativa a la anterior, puede ser necesaria para algunas apps específicas de Chrome/Electron.
# Mantener comentada a menos que `ELECTRON_OZONE_PLATFORM_HINT` no funcione para alguna app.

# --------------------------------------------------
# CONFIGURACIÓN DEL ESCRITORIO Y LA INTERFAZ
# --------------------------------------------------
env = XDG_SESSION_DESKTOP,Hyprland
env = XDG_CURRENT_DESKTOP,Hyprland
# Informa a las aplicaciones que el entorno de escritorio actual es Hyprland.

env = XCURSOR_THEME,catppuccin-frappe-lavender-cursors
env = XCURSOR_SIZE,24
# Establece el tema y tamaño del cursor para Wayland y XWayland.

env = TERMINAL,kitty -1
# Define el emulador de terminal por defecto que otras aplicaciones deben usar.

# --------------------------------------------------
# CONFIGURACIÓN DE QT
# --------------------------------------------------
env = QT_QPA_PLATFORM,wayland
# Indica a las aplicaciones Qt que se ejecuten de forma nativa en Wayland.

#env = QT_QPA_PLATFORM,wayland;xcb
# Opción de fallback a X11 (xcb) para Qt, mantener comentada si `wayland` funciona bien.

env = QT_QPA_PLATFORMTHEME,qt6ct
env = QT_QPA_PLATFORMTHEME,qt5ct
# Establece el tema para aplicaciones Qt a través de qt6ct.

env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1
# Deshabilita las decoraciones de ventana de la app (CSD) en favor de las de Hyprland (SSD).

env = QT_AUTO_SCREEN_SCALE_FACTOR,1
# Permite que las aplicaciones Qt escalen automáticamente en pantallas HiDPI.

#env = QT_STYLE_OVERRIDE,kvantum
# Fuerza el uso del motor de estilos Kvantum para una apariencia consistente.

# --------------------------------------------------
# OPCIONES AVANZADAS DEL DRIVER GRÁFICO
# --------------------------------------------------
env = __GL_GSYNC_ALLOWED,0
env = __GL_VRR_ALLOWED,0
# Desactiva G-Sync y Tasa de Refresco Variable (VRR).
# Recomendado para evitar parpadeos (flickering) en algunos monitores.

# --------------------------------------------------
# OPCIONES DE GPU NVIDIA PARA RENDIMIENTO (PRIME)
# --------------------------------------------------
# ⚠️ ADVERTENCIAS IMPORTANTES:
#    - Activar estas variables puede romper la compartición de pantalla.
#    - Algunas también deshabilitan el soporte de monitores externos.
#    - Recomendadas solo si el objetivo principal es jugar con el máximo rendimiento.

#env = __NV_PRIME_RENDER_OFFLOAD,1
# (Optimus) Activa PRIME Render Offload: iGPU para escritorio, dGPU para apps exigentes.

#env = __VK_LAYER_NV_optimus,NVIDIA_only
# (Optimus) Complemento para Vulkan: obliga a usar la dGPU de NVIDIA.

#env = __GL_THREADED_OPTIMIZATIONS,1
# (NVIDIA) Activa optimización multi-hilo en OpenGL. Puede causar problemas con monitores externos.

# =======================================================================================
# CONFIGURACIÓN DE XWAYLAND
# =======================================================================================
xwayland {
  force_zero_scaling = true
}

env = QT_QPA_PLATFORMTHEME,qt5ct

# =======================================================================================
#  SECCIÓN NVIDIA: FORZAR USO EXCLUSIVO DE LA GPU DEDICADA
# =======================================================================================
# ⚠️ ADVERTENCIA: Activar las siguientes variables forzará a todo el sistema
# (Hyprland, Wayland, XWayland y aplicaciones) a utilizar la GPU de NVIDIA
# en todo momento. Esto anula el modo híbrido y el ahorro de energía.
# Útil solo si se desea rendimiento máximo constante a costa de la batería.
# =======================================================================================
env = NVIDIA_DRIVER_CAPABILITIES,all
# Habilita la sincronización explícita (explicit sync) para Wayland.
# Soluciona problemas de bajo rendimiento (estados P5/P8) en NVIDIA.

env = LIBVA_DRIVER_NAME,nvidia
# Especifica el controlador de NVIDIA para la aceleración de video por hardware (VA-API).

env = NVD_BACKEND,direct
# Variable necesaria para el funcionamiento del controlador `nvidia-vaapi-driver`.

# La comunidad indica que esta variable sigue siendo necesaria.
env = GBM_BACKEND,nvidia-drm
# (NVIDIA) Establece el backend de renderizado GBM. Necesario para Wayland en GPUs NVIDIA.

env = __GLX_VENDOR_LIBRARY_NAME,nvidia
# (NVIDIA) Fuerza a XWayland a usar las librerías propietarias de NVIDIA para OpenGL.
